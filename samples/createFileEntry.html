<html>
<head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
</head>
<body>
  <script src="config.js"></script>
  <script src="../libs/dojo/dojo.js"></script>
  <script type="text/javascript">
      var test_contextId = "1";
      require(['store/EntryStore'], function(EntryStore) {
          var es = new EntryStore();
          es.auth({user: test_username, password: test_password}).then(function() {
              document.getElementById("upload").onclick = function() {
                  es.getContextById(test_contextId).newEntry().commit().then(function(entry) {
                      var inp = document.getElementById("input");
                      entry.getResource(true).putFile(inp).then(function() {
                          entry.refresh().then(function() {
                              var ei = entry.getEntryInfo();
                              document.getElementById("message").innerHTML = "File with mimetype "+
                                      ei.getFormat()+" and label " + ei.getLabel()+" succesfully uploaded: ";
                              var res = document.getElementById("link");
                              res.href = entry.getResourceURI();
                              res.innerHTML = "open in separate window/tab";
                              var res = document.getElementById("download");
                              res.href = entry.getResourceURI()+"?download";
                              res.innerHTML = "or download";
                          });
                      });
                  }, function(err) {
                      alert("Failed to create an entry! + err");
                  });
              }
          });
      });
  </script>
  <input id="input" type="file" name="uploadFile"/>
  <button id="upload">Upload</button>
  <hr>
  <span id="message"></span><a href="" id="link" target="_blank"></a>&nbsp;&nbsp;<a href="" id="download"></a>
</body></html>